based on https://blog.golang.org/pipelines

added context, readers cancelations
